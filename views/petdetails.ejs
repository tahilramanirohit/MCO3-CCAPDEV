<!DOCTYPE html>
<html>
    <html lang="en"></html>
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css">
        <link rel="stylesheet" href=
        "https://cdn.jsdelivr.net/npm/bootstrap-icons@1.5.0/font/bootstrap-icons.css" />
        <title><%= pet.name %></title>
    </head>

    <style>
        :root {
        --background-color: #f8f8ff;
        --secondary-color: #262731;
        --accent-color: #ae0c00;
        }

    .header{
        display: flex;
        flex-direction: row;
        background-color: white;
        width: 100%;
        margin: 0;
        padding: 0;
    }

    .logo{
        margin-top: 20px;
        margin-left: 20px;
    }

    .nav-link-custom{
        margin-top: 25px;
        margin-left: 0;
        margin-right: 10px;
        color: var(--secondary-color);
        font-family: Helvetica;
        font-size: 15px;
    }

    .nav-link-custom i{
        font-size: 1.5rem;
        margin-right: 2px;
    }

    .search-bar{
        margin-top: 25px;
        margin-left:550px;
        margin-right: auto;
        max-width: 600px;
    }

    .form-control{
        width: 300px;
    }
    .btn-search{
        border: 1px transparent;
        color: var(--secondary-color);
        border-radius: 5px; 
        margin-right: auto;
    }
    .btn-log{
        width: 80px;
        background-color: var(--accent-color);
        color: whitesmoke; 
        margin: 20px 25px 20px 12px;
        border-radius: 5px; 
        padding: 15px;
    }

    .login-box{
        display: flex;
        justify-content: center;    
    }

    nav, .navbar {
        margin: 0;
        padding: 0;
    }

    .body{
        display: flex;
       
        flex-direction: column;
        background-color: white;
        
        
    }

    .top-body{
        display: flex;
        flex-direction: row;
        align-items: center;
        justify-content: center;
    }

    .top-body-items{
        margin-left: 0;
        margin-right: 20px;
        color: var(--secondary-color);
        font-family: Helvetica;
        font-size: 15px;
        text-decoration: none;
        font-weight: bold;
    }
    .dropdown {
    position: relative;
    display: inline-block;
    }   

    .dropdown-content {
    display: none;
    position: absolute;
    background-color: white;
    min-width: 160px;
    box-shadow: 0px 8px 16px 0px rgba(0,0,0,0.2);
    z-index: 1;
    top: 100%;
    left: 0;
    }

    .dropdown-content a {
        color: var(--secondary-color);
        padding: 12px 16px;
        text-decoration: none;
        display: block;
    }

    .dropdown-content a:hover {
        background-color: #ddd;
    }

    .dropdown:hover .dropdown-content {
        display: block;
    }

    .dropdown:hover .top-body-items {
        background-color: #ddd;
    }
    

    .pet-page {
    display: flex;
    justify-content: center;
    align-items: center;
    padding: 20px;
}

.pet-content {
    display: flex;
    width: 80%;
    max-width: 1200px;
    position: relative;
}

.left-body {
    padding: 20px;
    border-radius: 15px;
    background-color: #fff;
}

.right-body {
            padding: 30px;
            background-color: whitesmoke;
            border-radius: 8px;
            margin-left: 10px;
            flex: 1;
            position: sticky;
            top: 100px; /* Adjust this value as needed */
            align-self: flex-start;
            
        }

.left-body {
    flex: 3;
    margin-right: 10px;
    
    display: flex;
    
    
}

.right-body {
    flex: 1;
    
    
}



form label {
    margin: 10px 0 5px;
}

form input, form select {
    padding: 10px;
    margin-bottom: 10px;
    border: 1px solid #ccc;
    border-radius: 4px;
}

.body-container {
    display: flex;
    flex-direction: column;
}

.body-inclusion {
    display: flex;
    justify-content: space-between;
    margin-bottom: 10px;
}

.pet-container {
    display: flex;
    flex-direction: column;
}

.pet-inclusion {
    display: flex;
    justify-content: space-between;
    margin-bottom: 10px;
}

.line {
    border-bottom: 1px solid #ccc;
    margin: 10px 0;
}





.text-container {
    margin: 20px 0;
}

.adopt-button-container {
    display: flex;
    justify-content: center;
    size: 100px;
}

.adopt-button {
    padding: 10px 20px;
    background-color: #000000;
    color: #fff;
    border: none;
    border-radius: 4px;
    cursor: pointer;
    justify-content: center;
    size: 100px;
}

.review-button-container {
    display: flex;
    justify-content: left;
}

.review-button {
    padding: 10px 20px;
    background-color: white;
    color: black;
    border: 1px solid black;
    border-radius: 4px;
    
    cursor: pointer;
}

.cookie {
    width: 800px;
}

span {
    color: red;
}

.pet-entry {
    display: flex;
    justify-content: space-between;
    align-items: center;
}

.pet-details{
    display: flex;
    flex-direction: column;
    
}

.pet-entry .pet-details {
    display: flex;
    align-items: normal;
    
    
}

.pet-entry .pet-details .pet-name {
    margin-right: 10px;
}

.pet-name {
    font-size: 30px;
}

.pet-body {
    font-size: 20px;
    font-weight: bold;
}

.form1 {
    display: flex;
    margin-top: 10px;
    
    
}

form label {
    margin: 10px 0 5px;
    margin-right: 10px;
    
}

form input, form select {
    padding: 10px;
    margin-bottom: 10px;
    border: 1px solid #ccc;
    border-radius: 4px;
}

.sizes {
    font-weight: 500;

}

.color-selector {
  
  display: flex;
  align-items: center;
}

.color-selector label {
  margin-right: 10px;
  font-weight: 500;
}

.colors {
  display: flex;
  gap: 10px;
}

.color-option {
  display: none;
}

.color-label {
  width: 40px;
  height: 40px;
  border: 1px solid black;
  cursor: pointer;
  background-size: cover;
  border: 1px solid #ccc;
  border-radius: 4px;
}

.color-option:checked + .color-label {
  border: 2px solid black;
}





.reminder {
    font-size: 10px;
    margin-top: 10px;
}




ul p {
    margin-top: 5px;
}

section {
    padding: 10px 0;
}

.test {
    display: flex;
    flex-direction: column;
}

.form-control{
        width: 300px;
    }

    label {
    margin-bottom: 5px;
}

input {
    margin-bottom: 10px;
    padding: 8px;
    border: 1px solid #ccc;
    border-radius: 4px;
}

button {
    padding: 10px;
    background-color: black;
    color: white;
    border: none;
    border-radius: 4px;
    cursor: pointer;
    align-self: start;
}

button:hover {
    background-color: #333;
}

span {
    color: red;
}

.dropdown-menu-custom {
    position: absolute !important; /* Prevents shifting content */
    right: 0; /* Aligns to the right */
    top: 100%; /* Places it directly below the button */
    z-index: 1050; /* Ensures it stays above other elements */
    box-shadow: 0px 4px 6px rgba(0, 0, 0, 0.1); /* Adds a slight shadow */
}

.dropdown:hover .dropdown-menu {
    display: block; /* Shows menu on hover */
}

.navbar-nav {
    display: flex;
    align-items: center;
    gap: 15px; /* Adjust spacing between items */
}

.nav-link-custom {
    display: flex;
    align-items: center;
    font-size: 16px;
    font-weight: bold;
    color: var(--secondary-color);
}


        

</style>

<body>
    <nav class="navbar bg-body-tertiary">
        <div class="containter-fluid header">
            <div class="logo">
                <a class="navbar-brand" href="/">
                    <img src="/images/title.png" alt="PAC" width="180px" height="50px">
                </a>
            </div>

            <div class="search-bar container">
                <form class="d-flex" role="search">
                    <input class="form-control me-2" type="search" placeholder="Search" aria-label="Search">
                    <button class="btn btn-search" type="submit">
                        <i class="bi bi-search"></i>
                    </button>
                </form>
            </div>

            <div class="navbar-nav d-flex align-items-center">
                <div class="dropdown">
                    <a id="account-link" class="nav-link nav-link-custom dropdown-toggle" href="#" role="button" data-bs-toggle="dropdown" aria-expanded="false">
                        <i class="bi bi-person"></i> <%= user ? user.name : 'Account' %>
                    </a>
            
                    <ul class="dropdown-menu dropdown-menu-custom">
                        <% if (user) { %>
                            <li>
                                <form action="/logout" method="GET">
                                    <button type="submit" class="dropdown-item">Logout</button>
                                </form>
                            </li>
                        <% } else { %>
                            <li><a class="dropdown-item" href="/login">Login</a></li>
                            <li><a class="dropdown-item" href="/register">Register</a></li>
                        <% } %>
                    </ul>
                </div>
            </div>
            
            
                                    
            <script>
document.addEventListener("DOMContentLoaded", function () {
    fetch('/api/user')
        .then(response => response.json())
        .then(data => {
            console.log("User Data:", data); // Debugging

            if (data && data.name && data.name !== "Account") {
                const accountLink = document.getElementById("account-link");
                const logoutButton = document.getElementById("logout");

                if (accountLink) {
                    accountLink.innerHTML = `<i class="bi bi-person"></i> ${data.name}`;
                } else {
                    console.warn("Element with ID 'account-link' not found.");
                }

                if (logoutButton) {
                    logoutButton.style.display = "block"; // Show logout button

                    // Logout functionality (only attach if button exists)
                    logoutButton.addEventListener("click", function (event) {
                        event.preventDefault();
                        fetch('/logout', { method: 'POST' })
                            .then(() => {
                                window.location.href = "/"; // Redirect to homepage
                            })
                            .catch(error => console.error("Error logging out:", error));
                    });
                } else {
                    console.warn("Logout button not found, cannot add event listener.");
                }
            } else {
                console.log("User not logged in or invalid data");
            }
        })
        .catch(error => console.error("Error fetching user data:", error));
});            </script>
                <a class="nav-link nav-link-custom" href="/pets"><i class="bi bi-heart"></i> Adopt Now!</a>
            </div>
        </div>
    </nav>

    <div class="body">
        <div class="top-body">
            <a class="top-body-items" href="/"> Home </a>
            <a class="top-body-items" href="/pets"> Our Pets </a>
            <a class="top-body-items" href="/about"> About Us </a>
            <a class="top-body-items" href="#faq"> FAQ </a>
            <a class="top-body-items" href="#contact"> Contact Us </a>
        </div>

        <div class="pet-page">
            <div class="pet-content">
                <div class="left-body">
                    <div class="pet">
                        <div class="pet-image">
                            <img src="/images/<%= pet.image %>" class="cookie" alt="<%= pet.name %>">
                            <div class="line"></div>
                            <h2 class="pet-review">Adoption Form</h2>
                            <div class="line"></div>

                            <!-- Adoption Form -->
                            <div class="container">
                                <div class="userprofile">
                                    <div class="section">
                                        <h2></h2>
                                        <form id="adoptForm" action="/adopt/<%= pet._id %>" method="POST">
                                            <input type="hidden" name="adopt" value="yes">
                                            
                                            <label for="pickupDate">Select Pickup Date:</label>
                                            <input type="date" id="pickupDate" name="pickupDate" required>
                                            
                                            <label for="pickupTime">Select Pickup Time:</label>
                                            <select id="pickupTime" name="pickupTime" required>
                                                <option value="12:00">12:00 PM</option>
                                                <option value="13:00">1:00 PM</option>
                                                <option value="14:00">2:00 PM</option>
                                                <option value="15:00">3:00 PM</option>
                                                <option value="16:00">4:00 PM</option>
                                                <option value="17:00">5:00 PM</option>
                                            </select>
                                
                                            
                                            <button type="submit" id="adoptButton">Adopt <%= pet.name %></button>
                                        </form>
                                
                                        <script>
                                            document.addEventListener("DOMContentLoaded", function () {
                                                const adoptForm = document.getElementById("adoptForm");
                                                const pickupDateInput = document.getElementById("pickupDate");
                                                const pickupTimeInput = document.getElementById("pickupTime");
                                
                                                // Restrict date selection to today or later
                                                const today = new Date().toISOString().split("T")[0];
                                                pickupDateInput.setAttribute("min", today);
                                
                                                adoptForm.addEventListener("submit", function (event) {
                                                    event.preventDefault(); // Prevent default submission
                                
                                                    const selectedTime = pickupTimeInput.value;
                                                    if (!selectedTime) {
                                                        alert("Please select a pickup time.");
                                                        return;
                                                    }
                                
                                                    const [hours, minutes] = selectedTime.split(":" ).map(Number);
                                                    if (hours < 12 || hours > 17 || (hours === 17 && minutes > 0)) {
                                                        alert("Please select a pickup time between 12:00 PM and 5:00 PM.");
                                                        return;
                                                    }
                                
                                                    // Submit the form using fetch
                                                    const formData = new FormData(adoptForm);
                                                    fetch(adoptForm.action, {
                                                        method: "POST",
                                                        body: formData
                                                    })
                                                    .then(response => response.json())
                                                    .then(data => {
                                                        if (data.success) {
                                                            alert("Adopted successfully! Redirecting to homepage...");
                                                            window.location.href = "/";
                                                        } else {
                                                            alert("Failed to adopt: " + data.message);
                                                        }
                                                    })
                                                    .catch(error => console.error("Error:", error));
                                                });
                                            });
                                        </script>
                                
                                            
                                          
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="line"></div>
                    </div>
                </div>

                <div class="right-body">
                    <div class="pet-container">
                        <div class="pet-entry">
                            <div class="pet-details">
                                <h1 class="pet-name"><%= pet.name %></h1>
                                <p class="pet-body">Age: <%= pet.age %> years</p>
                                <p class="pet-body">Gender: <%= pet.gender %></p>
                                <p><%= pet.description %></p>
                            </div>
                        </div>    
                    </div>
                    
                </div>
                
            </div>
            
        </div>
                <div id="faq" class="container mt-5">
            <div class="line"></div>
            <h2>Frequently Asked Questions</h2>
            <p><strong>Q: How do I adopt a pet?</strong><br>A: Simply browse our pet listings and click "Adopt Now" to start the process.</p>
            <p><strong>Q: Is there an adoption fee?</strong><br>A: Yes, a small fee is required to cover veterinary costs and care.</p>
            <p><strong>Q: Do you adopt animals?</strong><br>A: PAC does not adopt animals we rescue them.</p>
            <p><strong>Q: Can I return my adopted pet if I change my mind?</strong><br>A: A pet is a lifetime commitment. However, if you truly can't keep your adopted pet, <br>Please return them to us so we can find another home for them.</p>
            <p><strong>Q: Do you have puppies or kittens for adoption?</strong><br>A: Puppies and kittens are only available for fostering for up to 6 months, <br>or until they are vaccinated and neutered.</p>
        </div>
        <div id="contact" class="container mt-5" >
            <h2>Contact Us</h2>
            <p>Email: support@ourwebsite.com</p>
            <p>Phone: +123 456 7890</p>
            <p>Address: 123 Pet Adoption Street, City, Country</p>
        </div>

    </div>
</body>

</html>
